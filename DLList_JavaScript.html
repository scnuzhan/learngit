<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
	<meta charset="UTF-8">
	<title>数据结构双链表JavaScript描述</title>
	<link rel="stylesheet" href="css/styles.css">
	<style>
	p.content {
	   margin-top: 0.5em;
	   margin-bottom: 0.5em;
	   padding-left: 10px;
	}
	div.insertcity1 {
	   margin-top: 12px;
	   padding: 10px;
	}
	div.insertcity2 {
	   padding: 10px;
	}
	div.deletecity {
	   padding: 10px;
	}
	div.deletecity {
	   margin-top: 20px;
	}
	div.button {
		margin-left: 30px;
	}
	/*div.button input {
	   margin: 0 5px;
	}*/
	</style>
</head>
<body>
	<header>
		<h1>数据结构作业（JavaScript描述）</h1>
	</header>

	<aside class="sidebar">
		<nav class="clear">
			<ul>
				<li><a href="http://scnuzhan.github.io/learngit/Queue_JavaScript.html">顺序存储操作</a></li>
				<li><a href="http://scnuzhan.github.io/learngit/LList_JavaScript.html">单链表操作</a></li>
				<li><a href="http://scnuzhan.github.io/learngit/DLList_JavaScript.html">双链表操作</a></li>
			</ul>
		</nav>
		<h2>双链表基本操作</h2>
		<p class="content">链表中原始数据为：</p>
		<p class="content">"北京""上海""广州""深圳""杭州"</p>
		<div class="insertcity1">
		   <label for="precity">插入位置</label>
		   <input type="text" id="precity" placeholder="头节点为head">
		</div>
		<div class="insertcity2">
		   <label for="incity">城市名称</label>
		   <input type="text" id="incity" placeholder="广州">
		</div>
		<div class="button">
		   <input type="button" value="插入" id="insertbutton">
		   <input type="button" value="显示链表" id="showbutton1">
		   <input type="button" value="反序显示链表" id="reshowbutton1">
		</div>
		<div class="deletecity">
		   <label for="decity">城市名称</label>
		   <input type="text" id="decity" placeholder="广州">
		</div>
		<div class="button">
		   <input type="button" value="删除" id="deletebutton">
		   <input type="button" value="显示链表" id="showbutton2">
		   <input type="button" value="反序显示链表" id="reshowbutton2">
		</div>
	</aside>

	<main>
		<h3>结果：</h3>
		<p id="result"></p>
	</main>

	<footer>
		<p>詹前壕&copy;</p>
	</footer>

	<script>
		function Node(element) {
		   this.element = element;
		   this.next = null;
		   this.previous = null;
		}

		function LList() {
		   this.head = new Node("head");
		   this.find = find;
		   this.findNext = findNext;
		   this.insert = insert;
		   this.display = display;
		   this.remove = remove;
		   this.findLast = findLast;
		   this.dispReverse = dispReverse;
		}

		function dispReverse() {
		   var currNode = this.head;
		   currNode = this.findLast();
		   result.innerHTML += "链表反序数据：";
		   while (!(currNode.previous == null)) {
		      // console.log(currNode.element);
		      result.innerHTML += JSON.stringify(currNode.element);
		      currNode = currNode.previous;
		   }
		   result.innerHTML += "<br>";
		}

		function findLast() {
		   var currNode = this.head;
		   while (!(currNode.next == null)) {
		      currNode = currNode.next;
		   }
		   return currNode;
		}

		function remove(item) {
		   var currNode = this.find(item);
		   if (!(currNode.next == null)) {
		       currNode.previous.next = currNode.next;
		       currNode.next.previous = currNode.previous;
		       currNode.next = null;
		       currNode.previous = null;
		   }
		   else {
		   	currNode.previous.next = null;
		   	currNode.previous = null;
		   }
		}

		function display() {
		   var currNode = this.head;
		   result.innerHTML += "链表数据：";
		   while (!(currNode.next == null)) {
		      // console.log(currNode.next.element);
		      result.innerHTML += JSON.stringify(currNode.next.element);
		      currNode = currNode.next;
		   }
		   result.innerHTML += "<br>";
		}

		function find(item) {
		   var currNode = this.head;
		   while (currNode.element != item) {
		      currNode = currNode.next;
		   }
		   return currNode;
		}

		function findNext(item) {
			var currNode = this.head;
			while (currNode.element != item) {
			   currNode = currNode.next;
			}
			/*    //插入头节点head后疑似bug
			if (currNode.next == "head")
				return currNode;
			*/
			var nextNode = currNode.next;
			return nextNode;
		}

		function insert(newElement, item) {
		   var newNode = new Node(newElement);
		   var current = this.find(item);
		   newNode.next = current.next;
		   newNode.previous = current;
		   // current.next.previous = newNode;
		   var nextNode = this.findNext(item);
		   if ((nextNode != current) && current.next != null)
		   nextNode.previous = newNode;
		   current.next = newNode;
		}
		   

		var cities = new LList();
		cities.insert("北京", "head");
		cities.insert("上海", "北京");
		cities.insert("广州", "上海");
		cities.insert("深圳", "广州");
		cities.insert("杭州", "深圳");


		var insert=document.getElementById('insertbutton'),
		delBtn=document.getElementById('deletebutton'),
		getBtn1=document.getElementById('showbutton1'),
		getBtn2=document.getElementById('showbutton2'),
		regetBtn1=document.getElementById('reshowbutton1'),
		regetBtn2=document.getElementById('reshowbutton2'),
		result=document.getElementById('result');


		insertbutton.onclick=function(){
		   var item=document.getElementById("precity").value;
		   var newElement=document.getElementById("incity").value;
		   cities.insert(newElement, item);
		}

		getBtn1.onclick=function(){
		   cities.display()
		}
		getBtn2.onclick=function(){
		   cities.display()
		}

		regetBtn1.onclick=function(){
			cities.dispReverse()
		}
		regetBtn2.onclick=function(){
			cities.dispReverse()
		}

		delBtn.onclick=function(){
		   var item=document.getElementById('decity').value;
		   cities.remove(item);
		}


	</script>
</body>
</html>
